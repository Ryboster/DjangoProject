{% extends 'app1/pages/blank.html' %}

{% load static %}

{% block styles %}
<link rel="stylesheet" href="{% static 'styles/blog/buttons.css' %}">
<link rel="stylesheet" href="{% static 'styles/blog/sidebar.css' %}">


<button class="Button" onclick="toggleDeletePostForm(this)">
    <img style="padding:0" src="{% static 'assets/icons/trash_icon1.svg' %}" >
</button>

<div id="deletePostForm" style="display:none">
    <form method="POST" action="{% url 'delete_post' %}">
        {% csrf_token %}
        
        <input type="hidden" name="ID" value="">
        <input type="hidden" name="table" value="">

        <button type="submit">Confirm</button>
    </form>
</div>
{% endblock styles %}




{% block textContent %}

    <div id="Title">
        <h1 style="display:inline-flex;"> 
            {{ Title }}

            <div class="adminButtonsContainer">
                <button class="Button" onclick="toggleEditForm(this)">
                    <img style="padding:0" src="{% static 'assets/icons/edit_icon.svg' %}" >
                </button>
                <button class="Button" onclick="toggleDeleteForm(this)">
                    <img style="padding:0" src="{% static 'assets/icons/trash_icon1.svg' %}" >
                </button>
            </div>

        </h1>
    </div>

    
    <div id="Rating">
        <h3 style="display:inline-flex;">
            {{ Rating }} / 5

            <div class="adminButtonsContainer">
                <button class="Button" onclick="toggleEditForm(this)">
                    <img style="padding:0" src="{% static 'assets/icons/edit_icon.svg' %}" >
                </button>
                <button class="Button" onclick="toggleDeleteForm(this)">
                    <img style="padding:0" src="{% static 'assets/icons/trash_icon1.svg' %}" >
                </button>
            </div>

        </h3>
    </div>


    <p> {{ Pictures }} </p>
    
    <div id="Paragraph">
        <div style="display:flex; justify-content: center;"> 
            {{ Paragraph }}

            <div class="adminButtonsContainer">
                <button class="Button" onclick="toggleEditForm(this)">
                    <img style="padding:0" src="{% static 'assets/icons/edit_icon.svg' %}" >
                </button>
                <button class="Button" onclick="toggleDeleteForm(this)">
                    <img style="padding:0" src="{% static 'assets/icons/trash_icon1.svg' %}" >
                </button>
            </div>

        </div>
    </div>


    

<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function () {
        var textContainerTag = document.getElementsByClassName("textContainer")[0];
        textContainerTag.id = "{{ ID|escapejs }}";
    });
</script>

<script>
    function toggleEditForm(button) {
        var form = document.getElementById('editForm');

        var table = "Blog";
        var column = button.closest("div").parentElement.parentElement.id;
        var ID = "{{ ID|escapejs }}";

        form.querySelector('input[name="table"]').value = table;
        form.querySelector('input[name="column"]').value = column;
        form.querySelector('input[name="ID"]').value = ID;


        if (form.style.display === 'none' || form.style.display === '') {
            form.style.display = 'block';
        } else {
            form.style.display = 'none';
        }
    }

    function toggleDeleteForm(button) {
        var form = document.getElementById("deleteForm");

        var table = "Blog";
        var column = button.closest("div").parentElement.parentElement.id;
        var ID = "{{ ID|escapejs }}";

        form.querySelector('input[name="table"]').value = table;
        form.querySelector('input[name="column"]').value = column;
        form.querySelector('input[name="ID"]').value = ID;

        if (form.style.display === 'none' || form.style.display === '') {
            form.style.display = 'block';
        } else {
            form.style.display = 'none';
        }
    }

    function toggleDeletePostForm(button) {
        var form = document.getElementById("deletePostForm");

        var table = "Blog";
        var ID = "{{ ID|escapejs }}";
        
        form.querySelector('input[name="ID"]').value = ID;
        form.querySelector('input[name="table"]').value = table;

        if (form.style.display === 'none' || form.style.display === '') {
            form.style.display = 'block';
        } else {
            form.style.display = 'none';
        }
    }

    function toggleCreateForm(button) {
        var form = document.getElementById("createForm");

        var table = "Blog"

        form.querySelector('input[name="table"]').value = table;
    
        if (form.style.display === 'none' || form.style.display === '') {
            form.style.display = 'block';
        } else {
            form.style.display = 'none';
        }
    }
</script>
        


<div id="editForm" style="display: none;">
    <form method="POST" action="{% url 'update' %}">
        {% csrf_token %}
        <input type="text" name="new_value" placeholder="Enter new title" required style="margin-top:0;">
        
        <input type="hidden" name="ID" value="">
        <input type="hidden" name="table" value="">
        <input type="hidden" name="column" value="">

        <button type="submit">Confirm</button>
    </form>
</div>

<div id="deleteForm" style="display:none">
    <form method="POST" action="{% url 'delete' %}">
        {% csrf_token %}
        
        <input type="hidden" name="ID" value="">
        <input type="hidden" name="table" value="">
        <input type="hidden" name="column" value="">

        <button type="submit">Confirm</button>
    </form>
</div>




{{ text }}

{% endblock %}

{% block sidebarContent %}
    <div class="sidebarContainer">

        <h3 class="header">Content</h3>

        <h4 class="header"> Games </h4>
        <ul id="gamesList">
            {% for endpoint, title in EndpointPairs %}
            <li> <a href="/blog/{{ endpoint }}">{{ title }} </a></li>
            {% endfor %}

        </ul>

        <button onclick="toggleCreateForm(this)">
            +
        </button>


        <div id="createForm" style="display:none;">
            <form method="POST" action="{% url 'create' %}">
                {% csrf_token %}
                
                <input type="hidden" name="table" value="">

                <input type="text" name="id" value="">
                <input type="text" name="title" value="">
        
                <button type="submit">Confirm</button>
            </form>
        </div>
    </div>

{% endblock %}